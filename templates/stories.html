
{% extends "base.html" %}

{% block title %}Graduate Stories – GradGuide{% endblock %}

{% block body_class %} class="stories-page"{% endblock %}

{% block content %}
<!-- Search and Filter Section -->
<div class="container mt-4">
  <div class="row mb-4">
    <div class="col-md-8">
      <input type="text" id="searchInput" class="form-control" placeholder="Search by company, role, or university...">
    </div>
    <div class="col-md-4">
      <select id="outcomeFilter" class="form-select">
        <option value="">All Outcomes</option>
        <option value="Success">Success Only</option>
        <option value="Rejected">Rejected</option>
        <option value="Pending">Pending</option>
      </select>
    </div>
  </div>
</div>
<div class="hero-section">
  <div class="container text-center">
    <h1 class="hero-title">Graduate Stories</h1>
    <p class="hero-subtitle">Real experiences from graduates across Australia</p>
  </div>
</div>

<div class="main-content">
  <div class="container p-5">
    <a href="/" class="btn btn-link text-decoration-none mb-4">← Back to home</a>

    {% if submissions %}
      <div class="row g-4">
        {% for submission in submissions %}
          <div class="col-md-6">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title role-title">{{ submission.role }} at 
                  <a href="/company/{{ submission.company|urlencode }}" class="company-link">{{ submission.company }}</a>
                </h5>

                <div class="mb-2">
                  <strong>Type:</strong> {{ submission.experience_type or 'Not specified' }}
                </div>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchInput');
    const outcomeFilter = document.getElementById('outcomeFilter');
    const storyCards = document.querySelectorAll('.story-card');

    function filterStories() {
        const searchTerm = searchInput.value.toLowerCase();
        const selectedOutcome = outcomeFilter.value;

        storyCards.forEach(card => {
            const company = card.querySelector('.company-name')?.textContent.toLowerCase() || '';
            const role = card.querySelector('.role-title')?.textContent.toLowerCase() || '';
            const university = card.querySelector('.university')?.textContent.toLowerCase() || '';
            const outcome = card.querySelector('.badge')?.textContent.toLowerCase() || '';

            const matchesSearch = company.includes(searchTerm) || 
                                role.includes(searchTerm) || 
                                university.includes(searchTerm);
            
            const matchesOutcome = !selectedOutcome || outcome.includes(selectedOutcome.toLowerCase());

            if (matchesSearch && matchesOutcome) {
                card.style.display = 'block';
                card.classList.add('fade-in');
            } else {
                card.style.display = 'none';
                card.classList.remove('fade-in');
            }
        });
    }

    searchInput.addEventListener('input', filterStories);
    outcomeFilter.addEventListener('change', filterStories);
});
</script>

                <div class="mb-2">
                  <strong>University:</strong> {{ submission.university or 'N/A' }} 
                  {% if submission.wam %}(WAM: {{ submission.wam }}){% endif %}
                </div>

                <div class="mb-2">
                  <strong>Salary:</strong> 
                  {% if submission.salary %}${{ "{:,}".format(submission.salary|int) }}{% else %}Not disclosed{% endif %}
                  {% if submission.bonus %} + {{ submission.bonus }} bonus{% endif %}
                </div>

                <div class="mb-3">
                  <strong>Outcome:</strong>
                  {% if submission.outcome == 'Success' %}
                    <span class="badge success-badge">Success</span>
                  {% elif submission.outcome == 'Rejected' %}
                    <span class="badge rejected-badge">Rejected</span>
                  {% else %}
                    <span class="badge ghosted-badge">Ghosted</span>
                  {% endif %}
                </div>

                {% if submission.interview_experience %}
                  <div class="mb-2">
                    <strong>Interview:</strong> {{ submission.interview_experience[:150] }}{% if submission.interview_experience|length > 150 %}...{% endif %}
                  </div>
                {% endif %}

                {% if submission.advice %}
                  <div class="fst-italic mb-2">"{{ submission.advice[:200] }}{% if submission.advice|length > 200 %}...{% endif %}"</div>
                {% endif %}

                <div class="text-muted small">
                  Submitted {{ submission.timestamp.split('T')[0] }}
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty-state">
        <h4>No stories yet</h4>
        <p class="text-muted mb-4">Be the first to share your graduate experience!</p>
        <a href="/submit" class="btn btn-primary">Share Your Story</a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
